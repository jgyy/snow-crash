@startuml level03_exploit
title Level03 - PATH Manipulation / setuid Privilege Escalation

actor Attacker
participant "/tmp" as Tmp
participant "level03 (setuid)" as Binary
participant "flag03" as Flag03
participant "Real Binary" as RealBinary

Attacker -> Tmp: Create fake 'echo' binary
Tmp --> Attacker: Fake echo ready

Attacker -> Tmp: export PATH=/tmp:$PATH
Attacker -> Binary: ./level03

Binary -> Tmp: system("echo Level03")
note right of Tmp
  Looks for 'echo' in PATH
  Finds fake echo first (/tmp/echo)
end note

Tmp --> Tmp: Fake echo with getflag
Tmp -> Flag03: Execute with setuid privileges
Flag03 --> Tmp: qi0maab88jeaj46qoumi7maus
Tmp --> Binary: Return to level03
Binary --> Attacker: qi0maab88jeaj46qoumi7maus

@enduml
