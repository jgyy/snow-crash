@startuml level09_exploit
title Level09 - Position-Based Character Shift Cipher Decoding

actor Attacker
participant "/home/user/level09/token" as TokenFile
participant "Cipher Decoder" as Decoder
participant "flag09 Binary" as Binary
participant "flag09" as Flag09

Attacker -> TokenFile: Read encoded token
TokenFile --> Attacker: f4kmm6p|=... (binary data)

Attacker -> Decoder: Decode each character
note right of Decoder
  For each byte at position i:
  original = (encoded_byte - i) % 256

  Position 0: f - 0 = f
  Position 1: 4 - 1 = 3
  Position 2: k - 2 = i
  ...continues for all positions
end note

Decoder -> Decoder: Extract alphanumeric chars
Decoder --> Attacker: f3iji1ju5yuevaus41q1afiuq

Attacker -> Binary: SSH as flag09
Binary -> Flag09: Authenticate with decoded password
Flag09 -> Flag09: getflag
Flag09 --> Binary: s5cAJpM8ev6XHw998pRWG728z
Binary --> Attacker: s5cAJpM8ev6XHw998pRWG728z

@enduml
