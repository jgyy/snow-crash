@startuml level05_exploit
title Level05 - Cron Job Privilege Escalation

actor Attacker
participant "/opt/openarenaserver" as Opt
participant "Cron Daemon" as Cron
participant "flag05" as Flag05
participant "Token File" as TokenFile

Attacker -> Opt: Create exploit script in writable dir
Opt --> Attacker: Script ready

Cron -> Cron: Scheduled job runs as flag05
note right of Cron
  Every 2 minutes
  Executes scripts in /opt/openarenaserver
end note

Cron -> Opt: Execute flag05_exploit.sh
Opt -> Flag05: Run with flag05 privileges
Flag05 -> TokenFile: getflag > /tmp/token.txt
TokenFile --> Flag05: Write token file

Attacker -> TokenFile: Read token file
TokenFile --> Attacker: viuaaale9huek52boumoomioc

@enduml
